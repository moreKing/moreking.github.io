import{_ as i,c as a,ai as n,o as t}from"./chunks/framework.DcWFUpHS.js";const g=JSON.parse('{"title":"数据类型","description":"","frontmatter":{},"headers":[],"relativePath":"firewall/nftables/01/03.md","filePath":"firewall/nftables/01/03.md","lastUpdated":1737611111000}'),e={name:"firewall/nftables/01/03.md"};function l(p,s,h,k,r,d){return t(),a("div",null,s[0]||(s[0]=[n(`<h1 id="数据类型" tabindex="-1">数据类型 <a class="header-anchor" href="#数据类型" aria-label="Permalink to &quot;数据类型&quot;">​</a></h1><p><em>nft describe</em> 您可以使用 nft describe 来获取有关数据类型的信息，找出特定选择器的数据类型，并列出该选择器的预定义符号常量</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nft describe iif</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">meta</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> expression,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> datatype</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iface_index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (network </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">interface</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">basetype</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), 32 bits</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nft describe iifname</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">meta</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> expression,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> datatype</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ifname</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (network </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">interface</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">basetype</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), 16 characters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]#</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>以下是可用匹配项的不完整列表：</p><ul><li>meta (元属性，例如 interfaces)</li><li>icmp (ICMP 协议)</li><li>icmpv6 (ICMPv6 协议)</li><li>ip (IP 协议)</li><li>ip6 (IPv6 协议)</li><li>tcp (TCP 协议)</li><li>udp (UDP 协议)</li><li>sctp (SCTP 协议)</li><li>ct (连接跟踪 connection tracking)</li></ul><div class="language-yml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">meta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  oif &lt;output interface INDEX&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  iif &lt;input interface INDEX&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  oifname &lt;output interface NAME&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  iifname &lt;input interface NAME&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  （oif 和 iif 接受字符串参数并转换为接口索引）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  （oifname 和 iifname 更动态，但由于字符串匹配，速度较慢）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">icmp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  type &lt;icmp type&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">icmpv6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  type &lt;icmpv6 type&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  protocol &lt;protocol&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  daddr &lt;destination address&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  saddr &lt;source address&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ip6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  daddr &lt;destination address&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  saddr &lt;source address&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">tcp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  dport &lt;destination port&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  sport &lt;source port&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">udp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  dport &lt;destination port&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  sport &lt;source port&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">sctp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  dport &lt;destination port&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  sport &lt;source port&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  state &lt;new | established | related | invalid&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h3 id="_1-数据包元信息匹配" tabindex="-1">1. 数据包元信息匹配 <a class="header-anchor" href="#_1-数据包元信息匹配" aria-label="Permalink to &quot;1. 数据包元信息匹配&quot;">​</a></h3><p>元选择器允许您匹配 - 在某些情况下，设置 - 数据包元信息。也就是说，本地主机拥有的有关数据包的信息（例如如何/何时接收数据包），这些信息不一定在数据包本身中携带。</p><p>以下元选择器通过数据包本身携带的信息来匹配数据包：</p><table tabindex="0"><thead><tr><th style="text-align:center;">Keyword</th><th style="text-align:center;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Setting_packet_metainformation" target="_blank" rel="noreferrer">Settable</a></th><th style="text-align:left;">Description</th><th style="text-align:left;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Data_types" target="_blank" rel="noreferrer">Data Type 数据类型</a></th><th style="text-align:left;">Notes</th></tr></thead><tbody><tr><td style="text-align:center;"><em>pkttype</em></td><td style="text-align:center;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Setting_packet_metainformation" target="_blank" rel="noreferrer">Y</a></td><td style="text-align:left;">packet type (<em>unicast</em>, <em>broadcast</em>, <em>multicast</em>, <em>other</em>)</td><td style="text-align:left;">pkt_type</td><td style="text-align:left;">host 0[不建议使用]<br>单拨unicast 0<br>广播broadcast 1<br>多播multicast 2<br>其他other 3</td></tr><tr><td style="text-align:center;"><em>length</em></td><td style="text-align:center;"></td><td style="text-align:left;">数据包长度（以字节为单位）</td><td style="text-align:left;">integer (32 bit)</td><td style="text-align:left;"></td></tr><tr><td style="text-align:center;"><em>protocol</em></td><td style="text-align:center;"></td><td style="text-align:left;">数据包 协议/EtherType 协议值</td><td style="text-align:left;">ether_type</td><td style="text-align:left;">as in skb-&gt;protocol</td></tr><tr><td style="text-align:center;"><em>nfproto</em></td><td style="text-align:center;"></td><td style="text-align:left;">NetFilter 数据包协议族</td><td style="text-align:left;">integer (32 bit)</td><td style="text-align:left;">如IPv4、IPv6，etc....;<strong>仅在 Inet 表中有用</strong></td></tr><tr><td style="text-align:center;"><em>l4proto</em></td><td style="text-align:center;"></td><td style="text-align:left;">layer 4 protocol 第 4 层协议</td><td style="text-align:left;">integer (8 bit) 整数（8 位）</td><td style="text-align:left;">像TCP、UDP,etc......;跳过 IPv6 扩展标头</td></tr></tbody></table><h3 id="_2-接口匹配" tabindex="-1">2. 接口匹配 <a class="header-anchor" href="#_2-接口匹配" aria-label="Permalink to &quot;2. 接口匹配&quot;">​</a></h3><p>元选择器根据传入或传出接口匹配数据包,以下仅列出常用的匹配方式，完整内容请参考<a href="https://wiki.nftables.org/wiki-nftables/index.php/Matching_packet_metainformation#Matching_by_interface" target="_blank" rel="noreferrer">官网</a></p><table tabindex="0"><thead><tr><th style="text-align:center;">Keyword</th><th style="text-align:center;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Setting_packet_metainformation" target="_blank" rel="noreferrer">Settable</a></th><th style="text-align:left;">Description</th><th style="text-align:left;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Data_types" target="_blank" rel="noreferrer">Data Type</a></th><th style="text-align:left;">Notes</th></tr></thead><tbody><tr><td style="text-align:center;"><em>iif</em></td><td style="text-align:center;"></td><td style="text-align:left;">输入接口索引</td><td style="text-align:left;">iface_index</td><td style="text-align:left;">比 iifname 更快，因为它只需要比较一个 32 位无符号整数而不是一个字符串。接口索引是动态分配的，因此不要将其用于动态创建和销毁的接口，例如。PPP0 中。</td></tr><tr><td style="text-align:center;"><em>iifname</em></td><td style="text-align:center;"></td><td style="text-align:left;">输入接口名称</td><td style="text-align:left;">ifname</td><td style="text-align:left;"></td></tr><tr><td style="text-align:center;"><em>oif</em></td><td style="text-align:center;"></td><td style="text-align:left;">输出接口索引</td><td style="text-align:left;">iface_index</td><td style="text-align:left;">比 oifname 更快，因为它只需要比较一个 32 位无符号整数而不是一个字符串。 接口索引是动态分配的，因此不要将其用于动态创建和销毁的接口，例如。PPP0 中。</td></tr><tr><td style="text-align:center;"><em>oifname</em></td><td style="text-align:center;"></td><td style="text-align:left;">输出接口名称</td><td style="text-align:left;">ifname</td><td style="text-align:left;"></td></tr></tbody></table><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark has-diff vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ip a</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lo:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mtu</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 65536</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> qdisc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noqueue</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UNKNOWN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> qlen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    link/loopback</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:00:00:00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> brd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    inet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 127.0.0.1/8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scope</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lo</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       valid_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preferred_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    inet6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ::1/128</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scope</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       valid_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preferred_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ens33:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mtu</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1500</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> qdisc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fq_codel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> qlen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    link/ether</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:0c:29:03:19:e8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> brd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    inet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.1.26/24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> brd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.255</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scope</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noprefixroute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ens33</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       valid_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preferred_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    inet6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2408:8244:8600:43f:20c:29ff:fe03:19e8/64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scope</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dynamic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noprefixroute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       valid_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 245803sec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preferred_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 159403sec</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    inet6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fe80::20c:29ff:fe03:19e8/64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scope</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> link</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noprefixroute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       valid_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preferred_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nft add rule inet test chain1 meta iif 2 accept </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#//</span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nft add rule inet test chain1 meta iif ens33  accept </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#//</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nft -a -n list table inet test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 21</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	chain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chain2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		comment</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;常规链&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	chain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chain1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 58</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		comment</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;常规链&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> input</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> priority</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dport</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 66</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dport</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 70</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dport</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 443</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 67</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dport</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 114</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 71</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dport</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1443</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 68</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> saddr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> counter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packets</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 75</span></span>
<span class="line diff add"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		iif</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ens33&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 76 //</span></span>
<span class="line diff add"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		iif</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ens33&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 77 //</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	chain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chain4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 60</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> input</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> priority</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 110</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dport</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accept</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # handle 65</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]#</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h3 id="_3-按数据包标记、路由类别和领域进行匹配" tabindex="-1">3. 按数据包标记、路由类别和领域进行匹配 <a class="header-anchor" href="#_3-按数据包标记、路由类别和领域进行匹配" aria-label="Permalink to &quot;3. 按数据包标记、路由类别和领域进行匹配&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:center;">Keyword</th><th style="text-align:center;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Setting_packet_metainformation" target="_blank" rel="noreferrer">Settable</a></th><th style="text-align:left;">Description</th><th style="text-align:left;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Data_types" target="_blank" rel="noreferrer">Data Type 数据类型</a></th><th style="text-align:left;">Notes</th></tr></thead><tbody><tr><td style="text-align:center;"><em>mark</em></td><td style="text-align:center;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Setting_packet_metainformation" target="_blank" rel="noreferrer">Y</a></td><td style="text-align:left;">数据包标记</td><td style="text-align:left;">mark</td><td style="text-align:left;"></td></tr><tr><td style="text-align:center;"><em>priority</em></td><td style="text-align:center;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Setting_packet_metainformation" target="_blank" rel="noreferrer">Y</a></td><td style="text-align:left;">TC 数据包优先级</td><td style="text-align:left;">tc_handle</td><td style="text-align:left;"><a href="https://wiki.nftables.org/wiki-nftables/index.php/Classification_to_tc_structure_example" target="_blank" rel="noreferrer">detailed usage example 详细使用示例</a></td></tr><tr><td style="text-align:center;"><em>rtclassid</em></td><td style="text-align:center;"></td><td style="text-align:left;">路由领域</td><td style="text-align:left;">realm</td><td style="text-align:left;">Routing realm references: 路由领域引用：<a href="http://linux-ip.net/gl/ip-cref/ip-cref-node172.html" target="_blank" rel="noreferrer">linux-ip.net</a><a href="http://www.policyrouting.org/PolicyRoutingBook/ONLINE/CH07.web.html" target="_blank" rel="noreferrer">policyrouting.org</a></td></tr></tbody></table>`,16)]))}const y=i(e,[["render",l]]);export{g as __pageData,y as default};
